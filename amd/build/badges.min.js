/**
 * Javascript to badges manage.
 *
 * @module    block/ludifica
 * @copyright 2021 David Herney @ BambuCo
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("block_ludifica/badges",["jquery","core/notification","core/str","core/ajax","block_ludifica/alertc","block_ludifica/player","core/modal_factory","core/log","core/templates"],(function($,Notification,Str,Ajax,Alertc,Player,ModalFactory,Log,Templates){var strings=[{key:"badgelinkcopiedtoclipboard",component:"block_ludifica"}],s=[];strings.forEach((function(one){s[one.key]=one.key})),Str.get_strings(strings).then((function(results){return results.forEach((function(value,index){s[strings[index].key]=value})),!0})).fail((function(e){Log.debug("Error loading strings"),Log.debug(e)}));return{init:function(networks){$(".openshare").on("click",(function(){var $title=$(".share_badge_modal").attr("title"),badge={id:$(this).data("badgeid")},$badge=$("#badge-"+badge.id);badge.thumbnail=$badge.find(".thumbnail").attr("src"),badge.url=$badge.find(".shareurl").attr("href"),badge.name=$badge.data("name"),badge.year=$badge.data("year"),badge.month=$badge.data("month"),badge.uniquehash=$badge.data("uniquehash");var badgedata={networks:[],thumbnailurl:badge.thumbnail,badge:badge};return networks.forEach((function(network){var networkurl=network.url,badgeencode=badge.url.replace(/[=]/g,"%3d");networkurl=(networkurl=(networkurl=(networkurl=(networkurl=networkurl.replace(/{name}/gi,encodeURI(badge.name))).replace(/{url}/gi,badgeencode)).replace(/{badgeyear}/gi,badge.year)).replace(/{badgemonth}/gi,badge.month)).replace(/{badgeid}/gi,badge.uniquehash),badgedata.networks[badgedata.networks.length]={url:networkurl,icon:network.icon,iconsource:"core",name:network.icon}})),ModalFactory.create({title:$title,body:Templates.render("block_ludifica/sharebadge",badgedata)}).then((function(modal){return modal.show().then((function(){return $('input[name="badgelink"]').on("click",(function(){var $input=$(this);$input.select(),document.execCommand("copy");var $msg=$('<div class="msg-badgelink-copy">'+s.badgelinkcopiedtoclipboard+"</div>");$input.parent().append($msg),window.setTimeout((function(){$msg.remove()}),1600)})),!0}))})).fail((function(e){Log.debug("Error creating modal share buttons"),Log.debug(e)})),!0}))}}}));

//# sourceMappingURL=badges.min.js.map